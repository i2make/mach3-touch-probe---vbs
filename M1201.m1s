'' 5 axis calibration' 2017-11-20 ~ 2017-Const Xaxis = 0Const Yaxis = 1Const Zaxis = 2Const Aaxis = 3Const Baxis = 4Const Caxis = 5Dim XprobeP As SingleDim XprobeN As SingleDim YprobeP As SingleDim YprobeN As SingleDim ZprobeP As SingleDim ZprobeN As SingleDim Gap		As Single				'수평 단차Const Xcenter 	= 	255.3			'측정을 원하는 원의 대략의 X축 중심 좌표Const Ycenter 	= 	356.4			'측정을 원하는 원의 대략의 Y축 중심 좌표Const TestingPi =	54				'측정할 원의 파이Const PlanePi = 70					'수평측정할 원의 파이 Const ZHeight	=  -40				'Z축 내려가는 거리Const ZPlaneHeight = -40			'수평 Z축 내려가는 거리Const Pi = 3.14159265Const NormalFeedRate = 5			'일반 피드Const FeedRate = 400				'절삭 피드Const FastProbeFeedRate = 200		'빠른 프로브 속도Const SlowProbeFeedRate = 100		'느린 프로브 속도'-----------------------' 원점복귀'-----------------------'DoButton( 24 )		'Z축 원점복귀'DoButton( 22 )		'X축 원점복귀'DoButton( 23 )		'Y축 원점복귀'DoButton( 25 )		'A축 원점복귀'DoButton( 26 )		'B축 원점복귀'DoButton( 27 )		'C축 원점복귀'call SetDRO( Xaxis, Xcenter )'call SetDRO( Yaxis, Ycenter )'call SetDRO( Zaxis, 0 )'-----------------------' 터치프로브 위치로 이동'-----------------------'code ("G0 B0")'While IsMoving()'Wend'code ("G0 C0")'While IsMoving()'Wendcode ("G0 Z0")While IsMoving()Wendcode ("G0 Y0")While IsMoving()Wendcode ("G0 X0")While IsMoving()Wend' -----------------' 측정' -----------------If IsSuchSignal (22) Then			'터치브로브가 설정되었는가?' -----------------' 수평 측정' -----------------while (Gap<0.02 || Gap<-0.02)code ("G0 Z0")While IsMoving()Wendcode ("G0 X" & PlanePi-4)While IsMoving()Wendcode ("G0 Z" & ZPlaneHeight )While IsMoving()Wendcode ("G31 Z" & ZPlaneHeight-5 & "F" & SlowProbeFeedRate)While IsMoving()WendZprobeP = GetDRO(Zaxis)'---------------------------code ("G0 Z0")While IsMoving()Wendcode ("G0 X" & -PlanePi+4)While IsMoving()Wendcode ("G0 Z" & ZPlaneHeight )While IsMoving()Wendcode ("G31 Z" & ZPlaneHeight-5 & "F" & SlowProbeFeedRate)While IsMoving()WendZprobeN = GetDRO(Zaxis)Gap = ZprobeP - ZprobeNcode ("G1 B" & sin(Gap*Pi/180) & "F" & FeedRate)Wend' -----------------' 파이 중심 측정' -----------------code ("G0 X" & TestingPi/2+10)While IsMoving()Wendcode ("G0 Z" & ZHeight)While IsMoving()Wendcode ("G31 X0" & "F" & SlowProbeFeedRate)		'X+ probingWhile IsMoving()WendXprobeP = GetDRO(Xaxis)			'터치브로브값을 읽음code ("G0 X" & (XprobeP+3) )While IsMoving()Wendcode ("G0 Z0")While IsMoving()Wend'---------------------------------------code ("G0 X" & -(TestingPi/2+10))While IsMoving()Wendcode ("G0 Z" & ZHeight)While IsMoving()Wendcode ("G31 X0" & "F" & SlowProbeFeedRate)		'X- probingWhile IsMoving()WendXprobeN = GetDRO(Xaxis)			'터치브로브값을 읽음code ("G0 X" & (XprobeN-3) )While IsMoving()Wendcode ("G0 Z0")While IsMoving()Wendcode ("G0 X" & XprobeN+((XprobeP-XprobeN)/2))While IsMoving()Wendcall SetDRO( Xaxis, 0 )'-----------------------------------------code ("G0 Y" & TestingPi/2+10)While IsMoving()Wendcode ("G0 Z" & ZHeight)While IsMoving()Wendcode ("G31 Y0" & "F" & SlowProbeFeedRate)		'Y+ probingWhile IsMoving()WendYprobeP = GetDRO(Yaxis)			'터치브로브값을 읽음code ("G0 Y" & (YprobeP+3) )While IsMoving()Wendcode ("G0 Z0")While IsMoving()Wend'------------------------------------------code ("G0 Y" & -(TestingPi/2+10))While IsMoving()Wendcode ("G0 Z" & ZHeight)While IsMoving()Wendcode ("G31 Y0" & "F" & SlowProbeFeedRate)		'Y- probingWhile IsMoving()WendYprobeN = GetDRO(Yaxis)			'터치브로브값을 읽음code ("G0 Y" & (YprobeN-3) )While IsMoving()Wendcode ("G0 Z0")While IsMoving()Wendcode ("G0 Y" & YprobeN+((YprobeP-YprobeN)/2))While IsMoving()Wendcall SetDRO( Yaxis, 0 )'-------------------------------------End If                                                                                                                                                                                                             